<!-- Botões de ação -->
<div class="action-buttons">
  <!-- Botão para alternar visualização -->
  <button
    type="button"
    class="action-btn toggle-view-btn"
    [class.active]="isViewMode"
    (click)="toggleView()"
    [attr.aria-label]="isViewMode ? 'Editar conteúdo' : 'Visualizar conteúdo'"
  >
    <svg *ngIf="!isViewMode" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
      <path
        d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"
        stroke="currentColor"
        fill="none"
        stroke-width="2"
      />
      <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" />
    </svg>

    <svg *ngIf="isViewMode" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
      <path
        d="M17.94 17.94A10.94 10.94 0 0112 20C5 20 1 12 1 12a21.77 21.77 0 015.17-6.36M9.9 4.24A10.94 10.94 0 0112 4c7 0 11 8 11 8a21.77 21.77 0 01-2.29 3.49M1 1l22 22"
        stroke="currentColor"
        fill="none"
        stroke-width="2"
      />
    </svg>
  </button>

  <!-- Botão para limpar conteúdo -->
  <button
    type="button"
    class="action-btn clear-btn"
    (click)="clearContent()"
    [attr.aria-label]="'Limpar conteúdo'"
    [disabled]="empty"
  >
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
      <path
        d="M3 6h18"
        stroke="currentColor"
        fill="none"
        stroke-width="2"
      />
      <path
        d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"
        stroke="currentColor"
        fill="none"
        stroke-width="2"
      />
      <path
        d="M10 11v6"
        stroke="currentColor"
        fill="none"
        stroke-width="2"
      />
      <path
        d="M14 11v6"
        stroke="currentColor"
        fill="none"
        stroke-width="2"
      />
    </svg>
  </button>
</div>


<div class="rich-text-dynamic-container" [class.error]="isInvalid">
  
  <div class="input-group" [class.focused]="focused" [class.has-value]="hasValue">
    <!-- Label com asterisco vermelho quando required -->
    <label [class.focused]="focused || !empty">
      {{ config.placeholder }}
      <span *ngIf="config.required !== false" class="required-asterisk">*</span>
    </label>

    <div class="input-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" *ngIf="showImage">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
        <polyline points="14 2 14 8 20 8" />
        <line x1="16" y1="13" x2="8" y2="13" />
        <line x1="16" y1="17" x2="8" y2="17" />
        <polyline points="10 9 9 9 8 9" />
      </svg>
    </div>

    <!-- Wrapper principal -->
    <div class="quill-wrapper" [style.max-width]="'100%'">
      <!-- Editor -->
      <div *ngIf="!isViewMode" class="editor-container">
        <quill-editor
          class="quill-editor"
          [ngModel]="value"
          (ngModelChange)="onContentChange($event)"
          [modules]="quillModules"
          [placeholder]="config.placeholder"
          [styles]="editorStyles"
          [readOnly]="disabled"
          (onFocus)="onFocus()"
          (onBlur)="onBlur()"
          format="html"
        >
        </quill-editor>
      </div>

      <!-- Visualização -->
      <div *ngIf="isViewMode" class="rich-text-viewer" [innerHTML]="value"></div>
    </div>
  </div>

  <!-- Contador -->
  <div class="character-counter" *ngIf="showCount || showLimit">
    <span *ngIf="showCount" class="character-count">{{ characterCount }} characters</span>
    <span *ngIf="showLimit" class="character-limit" [class.exceeded]="isLimitExceeded">
      / {{ limit }}
    </span>
    <span *ngIf="showLimit && isLimitExceeded" class="limit-exceeded">
      ({{ characterCount - limit }} over)
    </span>
  </div>

  <!-- Mensagem de erro -->
  <span class="error-message" [class.show]="isInvalid && errorMessage">
    {{ errorMessage }}
  </span>
</div>
