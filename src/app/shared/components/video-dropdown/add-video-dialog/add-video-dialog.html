<div class="neu-modal-content">
  <!-- Cabe√ßalho -->
  <div class="modal-header">
    <div class="modal-title neu-emboss">
      {{ isEditMode ? '‚úèÔ∏è Editar Categoria' : 'üÜï Nova Categoria' }}
    </div>
    <button class="neu-button icon close" (click)="cancel()">
      <svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="4">
        <line x1="15" y1="5" x2="5" y2="15"></line>
        <line x1="5" y1="5" x2="15" y2="15"></line>
      </svg>
    </button>
  </div>

  <!-- Corpo do formul√°rio -->
  <div class="modal-body">
    <form [formGroup]="dropDownForm" class="form-container">
      <!-- T√≠tulo da Categoria -->
      <app-input-dynamic [config]="inputConfigs['dropdownTitle']" [control]="dropdownTitleControl" [showImage]="true">
      </app-input-dynamic>

      <!-- Form do V√≠deo - SEMPRE VIS√çVEL NO MODO NOVA CATEGORIA -->
      @if (showNewVideo) {
      <div class="new-video neu-card">
        <h3>{{ selectedVideo ? '‚úèÔ∏è Editar V√≠deo' : 'üÜï Adicionar V√≠deo' }}</h3>
        <form [formGroup]="videoForm" class="video-form">
          <app-input-dynamic [config]="inputConfigs['videoTitle']" [control]="videoTitleControl" [showImage]="true">
          </app-input-dynamic>
          <app-input-dynamic [config]="inputConfigs['youtubeUrl']" [control]="youtubeUrlControl" [showImage]="true">
          </app-input-dynamic>
          <app-select-dynamic [config]="inputConfigs['sector']" [control]="sectorControl" [showImage]="true">
          </app-select-dynamic>
          <div class="modal-actions">
            <button type="button" class="neu-button secondary" (click)="cancelVideoEdit()">
              {{ isEditMode ? 'Cancelar' : 'Limpar Campos' }}
            </button>
            <button type="button" class="neu-button primary" (click)="saveVideo()">
              {{ selectedVideo ? 'Atualizar Video' : 'Inserir Video' }}
            </button>
          </div>
        </form>
      </div>
      }

      <!-- Lista de V√≠deos (sempre vis√≠vel quando h√° v√≠deos) -->
      @if (hasVideos) {
      <div class="video-section">
        <h3>üìπ V√≠deos da Categoria ({{ dropDownVideos.videos.length }})</h3>
        <div class="video-list">
          @for (video of dropDownVideos.videos; track video.id) {
          <div class="video-item neu-card" [class.selected]="selectedVideo?.id === video.id" (click)="selectVideo(video)">
            <img [src]="getYouTubeThumbnail(video.youtubeUrl)" [alt]="video.videoTitle" class="video-thumb"
              (error)="handleImageError($event)">
            <div class="video-info">
              <h4 class="video-title">{{ video.videoTitle }}</h4>
              <p class="video-sector">{{ video.sector }}</p>
            </div>
            <button class="delete-btn" (click)="deleteVideo(video); $event.stopPropagation()" 
                    title="Excluir v√≠deo">
              <svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="15" y1="5" x2="5" y2="15"></line>
                <line x1="5" y1="5" x2="15" y2="15"></line>
              </svg>
            </button>
          </div>
          }
        </div>
      </div>
      } @else if (isEditMode) {
      <div class="no-videos neu-card">
        <p>üé¨ Ainda n√£o h√° v√≠deos cadastrados!</p>
      </div>
      }

      <!-- Bot√£o para adicionar novo v√≠deo (s√≥ aparece no modo edi√ß√£o quando n√£o est√° mostrando o formul√°rio) -->
      @if (isEditMode && !showNewVideo) {
      <div class="add-video-toggle">
        <button type="button" class="neu-button primary" (click)="addNewVideo()">
          ‚ûï Adicionar Novo V√≠deo
        </button>
      </div>
      }

      <!-- Bot√£o para adicionar mais v√≠deos (modo nova categoria quando j√° tem v√≠deos mas o formul√°rio n√£o est√° vis√≠vel) -->
      @if (!isEditMode && hasVideos && !showNewVideo) {
      <div class="add-video-toggle">
        <button type="button" class="neu-button primary" (click)="addNewVideo()">
          ‚ûï Adicionar Mais V√≠deos
        </button>
      </div>
      }

      <!-- Bot√µes principais -->
      <div class="modal-actions main-actions">
        <button type="button" class="neu-button secondary" (click)="cancel()">Cancelar</button>
        <button type="button" class="neu-button primary" (click)="save()">
          {{ isEditMode ? 'Atualizar' : 'Salvar' }}
        </button>
      </div>
    </form>
  </div>
</div>