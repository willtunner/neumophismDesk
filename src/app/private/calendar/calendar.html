<div class="calendar-page">

    <app-weather></app-weather>
    <!-- Header do CalendÃ¡rio Anual -->
    <div class="calendar-year-header neu-container">
        <div class="year-controls">
            <button class="neu-button icon" (click)="previousYear()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="15 18 9 12 15 6"></polyline>
                </svg>
            </button>
            <h1>{{ currentYear() }}</h1>
            <button class="neu-button icon" (click)="nextYear()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="9 18 15 12 9 6"></polyline>
                </svg>
            </button>
        </div>
    </div>

    <!-- Grid de Meses -->
    <div class="months-grid">
        <div *ngFor="let month of monthsGrid()" class="month-container neu-container">
            <div class="month-header">
                <h3>{{ month.name }}</h3>
            </div>

            <!-- Dias da semana -->
            <div class="weekdays-small">
                <div class="weekday-tiny" *ngFor="let day of weekDaysMini">{{ day }}</div>
            </div>

            <!-- Dias do mÃªs -->
            <div class="days-grid-small">
                <div *ngFor="let day of month.days" class="day-tiny" [class.other-month]="!day.isCurrentMonth"
                    [class.today]="day.isToday" [class.has-events]="day.hasEvents" (dblclick)="openEventModal(day.date)"
                    [title]="day.date | date:'fullDate'">
                    <span class="day-number-tiny">{{ day.number }}</span>
                    <div class="event-icon" *ngIf="day.hasEvents">ðŸŽ‰</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Lista de Eventos -->
    <div class="events-section neu-container">
        <div class="section-header">
            <h2>{{ 'CALENDAR.SCHEDULE_EVENTS' | translate }}</h2>
            <span class="events-count">{{ events().length }} {{ 'CALENDAR.EVENTS' | translate }}</span>
        </div>

        <div class="events-list">
            <div *ngFor="let event of sortedEvents()" class="event-item">
                <!-- Container principal com efeito de baixo relevo -->
                <div class="event-content-wrapper">

                    <!-- Data com efeito de baixo relevo -->
                    <div class="event-date-neu">
                        <div class="event-day">{{ event.date | date:'dd' }}</div>
                        <div class="event-month">{{ event.date | date:'MMM' }}</div>
                    </div>

                    <div class="event-details">
                        <div class="event-header">
                            <h4 class="event-title">{{ event.title }}</h4>
                            <div class="event-actions">
                                <button class="icon-button edit" (click)="editEvent(event)" title="Editar">
                                    <svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <path d="M9 4H3a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-6" />
                                        <path d="M16.5 2.5a2.121 2.121 0 0 1 3 3L10 13l-3 1 1-3 8.5-8.5z" />
                                    </svg>
                                </button>
                                <button class="icon-button delete" (click)="deleteEvent(event.id)" title="Excluir">
                                    <svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <polyline points="3 6 5 6 17 6" />
                                        <path
                                            d="M15 6v12a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <p class="event-description" *ngIf="event.description">{{ event.description }}</p>
                    </div>
                </div>
            </div>

            <div *ngIf="events().length === 0" class="no-events">
                <div class="empty-state">
                    <svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5" width="48"
                        height="48">
                        <path d="M12 2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V6z" />
                        <polyline points="12,2 12,6 16,6" />
                        <line x1="13" y1="11" x2="7" y2="11" />
                        <line x1="13" y1="14" x2="7" y2="14" />
                    </svg>
                    <p> {{ 'CALENDAR.NO_EVENTS' | translate }} </p>
                    <small> {{ 'CALENDAR.DOUBLE_CLICK_INSTRUCTION' | translate }} </small>
                </div>
            </div>
        </div>
    </div>
</div>